<!DOCTYPE html>
<html lang="en" ng-app="MyApp">
<head>
    <!--
    index.ejs is the file that loads all other pages in this single page application.
    We don't need a separate view folder for views in here, as this is really the only one that needs to be over here.
    If you really want to pass something through to the angular through ejs and dynamic scripting, you'll need to refresh the page.
    -->
    <base href="/">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title update-title></title>
    <!--
    Should we do a single page application?
    Without it, Angular frontend becomes a mess of dependencies in each page, especially with headers and footers.
    Also, think of the resumes that will go unadorned with the words single page application; it's the standard!
     -->
    <!-- Custom styles for this template -->
    <link href="shared/profile.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://www.parsecdn.com/js/parse-1.3.5.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->



</head>
<header ng-include="'shared/headers/header.ejs'"></header>
<body>
<div ui-view></div>
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>-->
<script src="https://code.angularjs.org/1.5.0/angular.min.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap.min.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-csp.css"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.8/angular-ui-router.min.js"></script>
<script src="https://code.angularjs.org/1.5.0/angular-resource.min.js"></script>

<script src="MyApp.js"></script>
<script>//This is bad code. not sure what to do with it.
   app.factory('serverInfo', function(){
        /*
         pass any information as an object called data within the object. Can't pass it directly for now; can't find a way.
         Call serverInfo() and include serverInfo in the dependencies at the top of the controller to access in javascript files
         Can't be done elsewhere as this is the only page generated dynamically.
         */
        return <%- locals ? JSON.stringify(locals) : "{}"%>;//works. define what you want to transfer as data in those
    })

    var generateResource = function(name) {//
        //console.log(name);
        app.factory(name, function ($resource) {
            var q = $resource('api/' + name + '/:_id', {_id: '@_id'}, {
                update: {
                    method: 'PUT'
                },
                create: {
                    method: 'POST'
                }
            });
            q.prototype.$save = function (callback) {
                if (this._id) {
                    return this.$update(callback);
                } else {
                    return this.$create(callback);
                }
            };

            return q;
        });

    }
    var modelNameList = <%- locals.models ? JSON.stringify(locals.models) : "{}"%>;
    for (var i = 0; i < modelNameList.length; i++)
        generateResource(modelNameList[i]);
</script>

<script src="components/register/Register.js"></script>
<script src="components/profile/profile.js"></script>
<script src="components/login/login.js"></script>
<script src="components/LogOut/LogOut.js"></script>
<script src="components/createAd/createAd.js"></script>
<script src="components/viewListing/viewListing.js"></script>
<script src="components/home/home.js"></script>
<script src="shared/headers/header.js"></script>
</body>
</html>